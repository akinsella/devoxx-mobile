define(["log","ui"],function(a,b){var c=a.getLogger("db");c.info("Loading db.js"),b.updateSplashscreenMessage("Chargement module database");var d={},e="xebia";c.info("Creating Lawnchair object");var f=new Lawnchair({name:e},function(a){c.info("Storage open for db: '"+a.name+"' with '"+a.adapter+"' adapter.");if(DB_NUKE){var b=this;b.keys({},function(a){_(a).each(function(a){(a.indexOf("/events/")>=0||a.indexOf("/xebia/")>=0)&&b.remove(a,function(){c.info("Destroyed following key in db: '"+a+"'")})})})}});return c.info("Created Lawnchair object"),d.exists=function(a,b){f.get(a,function(a){b(a)})},d.getName=function(){return e},d.save=function(a,b){f.save({key:a,value:b})},d.get=function(a,b){f.get(a,b)},d.isEquals=function(a,b,c,d){f.get(a,function(a){a&&a.value===b?c():d()})},d.getOrFetch=function(a,b,c){f.get(a,function(a){a?b(a.value):c()})},c.info("Loaded db"),d})